<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form">
    
    <Dialog
        id="createQualityTaskDialog"
        title="{i18n>dialog.createQualityTask}"
        contentWidth="75rem"
        resizable="true"
        stretch="{device>/system/phone}"
        aria-label="{i18n>aria.createQualityTaskDialog}"
        role="dialog">
        
        <content>
            <IconTabBar expandable="false">
                <items>
                    <!-- Basic Information Tab -->
                    <IconTabFilter text="{i18n>tab.basicInfo}" icon="sap-icon://hint">
                        <form:SimpleForm
                            editable="true"
                            layout="ResponsiveGridLayout">
                            <form:content>
                                <Label text="{i18n>taskName}" required="true" labelFor="taskNameInput"/>
                                <Input 
                                    id="taskNameInput"
                                    value="{create>/taskName}"
                                    placeholder="{i18n>placeholder.taskName}"
                                    aria-label="{i18n>aria.taskNameInput}"
                                    aria-required="true"
                                    valueState="{create>/taskNameState}"
                                    valueStateText="{create>/taskNameStateText}"
                                    liveChange=".onTaskNameChange"/>
                                
                                <Label text="{i18n>description}" labelFor="descriptionInput"/>
                                <TextArea 
                                    id="descriptionInput"
                                    value="{create>/description}"
                                    rows="{= ${device>/system/phone} ? 2 : 3 }"
                                    placeholder="{i18n>placeholder.description}"
                                    aria-label="{i18n>aria.descriptionInput}"/>
                                
                                <Label text="{i18n>qualityGate}" required="true" labelFor="qualityGateSelect"/>
                                <Select 
                                    id="qualityGateSelect"
                                    selectedKey="{create>/qualityGate}"
                                    aria-label="{i18n>aria.qualityGateInput}"
                                    aria-required="true"
                                    tooltip="{i18n>tooltip.qualityGate}"
                                    valueState="{create>/qualityGateState}"
                                    valueStateText="{create>/qualityGateStateText}"
                                    change=".onQualityGateChange">
                                    <core:Item key="" text="{i18n>placeholder.qualityGate}"/>
                                    <core:Item key="COMPLIANCE" text="{i18n>quality.gate.compliance}"/>
                                    <core:Item key="PERFORMANCE" text="{i18n>quality.gate.performance}"/>
                                    <core:Item key="SECURITY" text="{i18n>quality.gate.security}"/>
                                    <core:Item key="RELIABILITY" text="{i18n>quality.gate.reliability}"/>
                                    <core:Item key="USABILITY" text="{i18n>quality.gate.usability}"/>
                                    <core:Item key="MAINTAINABILITY" text="{i18n>quality.gate.maintainability}"/>
                                </Select>
                                
                                <Label text="{i18n>dataSource}" labelFor="dataSourceInput"/>
                                <Input 
                                    id="dataSourceInput"
                                    value="{create>/dataSource}"
                                    placeholder="{i18n>placeholder.dataSource}"
                                    valueState="{create>/dataSourceState}"
                                    valueStateText="{create>/dataSourceStateText}"
                                    liveChange=".onDataSourceChange"/>
                                
                                <Label text="{i18n>processingPipeline}" labelFor="processingPipelineInput"/>
                                <Input 
                                    id="processingPipelineInput"
                                    value="{create>/processingPipeline}"
                                    placeholder="{i18n>placeholder.processingPipeline}"/>
                            </form:content>
                        </form:SimpleForm>
                    </IconTabFilter>
                    
                    <!-- Evaluation Criteria Tab -->
                    <IconTabFilter text="{i18n>tab.evaluationCriteria}" icon="sap-icon://checklist" ariaDescribedBy="evaluationTabHelp">
                        <core:InvisibleText id="evaluationTabHelp" text="Configure quality evaluation components, thresholds, and assessment criteria"/>
                        <form:SimpleForm
                            editable="true"
                            layout="ResponsiveGridLayout"
                            labelSpanXL="4"
                            labelSpanL="4"
                            labelSpanM="12"
                            labelSpanS="12"
                            adjustLabelSpan="false"
                            emptySpanXL="0"
                            emptySpanL="0"
                            emptySpanM="0"
                            columnsXL="2"
                            columnsL="1"
                            columnsM="1"
                            class="sapUiResponsiveMargin">
                            <form:content>
                                <Label text="Quality Components to Evaluate"/>
                                <VBox>
                                    <CheckBox 
                                        text="{i18n>evaluation.compliance}"
                                        selected="{create>/evaluationCriteria/compliance}"
                                        aria-label="{i18n>aria.complianceCheckbox}"/>
                                    <CheckBox 
                                        text="{i18n>evaluation.performance}"
                                        selected="{create>/evaluationCriteria/performance}"/>
                                    <CheckBox 
                                        text="{i18n>evaluation.security}"
                                        selected="{create>/evaluationCriteria/security}"/>
                                    <CheckBox 
                                        text="{i18n>evaluation.reliability}"
                                        selected="{create>/evaluationCriteria/reliability}"/>
                                    <CheckBox 
                                        text="{i18n>evaluation.usability}"
                                        selected="{create>/evaluationCriteria/usability}"/>
                                    <CheckBox 
                                        text="{i18n>evaluation.maintainability}"
                                        selected="{create>/evaluationCriteria/maintainability}"/>
                                </VBox>
                                
                                <Label text="Quality Thresholds"/>
                                <VBox>
                                    <HBox>
                                        <Label text="{i18n>threshold.minQualityScore}" labelFor="minQualitySlider"/>
                                        <Slider 
                                            id="minQualitySlider"
                                            value="{create>/thresholds/minQualityScore}"
                                            min="0"
                                            max="100"
                                            step="5"
                                            width="{= ${device>/system/phone} ? '150px' : '200px' }"
                                            enableTickmarks="true"
                                            inputsAsTooltips="true"
                                            aria-label="{i18n>aria.minQualitySlider}"
                                            aria-valuemin="0"
                                            aria-valuemax="100"
                                            aria-valuenow="{create>/thresholds/minQualityScore}"/>
                                    </HBox>
                                    
                                    <HBox>
                                        <Label text="{i18n>threshold.maxIssues}"/>
                                        <StepInput 
                                            value="{create>/thresholds/maxIssues}"
                                            min="0"
                                            max="50"
                                            step="1"
                                            width="100px"/>
                                    </HBox>
                                    
                                    <HBox>
                                        <Label text="{i18n>threshold.minTrustScore}"/>
                                        <Slider 
                                            value="{create>/thresholds/minTrustScore}"
                                            min="0"
                                            max="100"
                                            step="5"
                                            width="200px"
                                            enableTickmarks="true"
                                            inputsAsTooltips="true"/>
                                    </HBox>
                                </VBox>
                            </form:content>
                        </form:SimpleForm>
                    </IconTabFilter>
                    
                    <!-- Routing Configuration Tab -->
                    <IconTabFilter text="{i18n>tab.routingConfig}" icon="sap-icon://activity-2" ariaDescribedBy="routingTabHelp">
                        <core:InvisibleText id="routingTabHelp" text="Configure routing strategy, thresholds, fallback options, and priority weighting"/>
                        <form:SimpleForm
                            editable="true"
                            layout="ResponsiveGridLayout"
                            labelSpanXL="4"
                            labelSpanL="4"
                            labelSpanM="12"
                            labelSpanS="12"
                            adjustLabelSpan="false"
                            emptySpanXL="0"
                            emptySpanL="0"
                            emptySpanM="0"
                            columnsXL="2"
                            columnsL="1"
                            columnsM="1"
                            class="sapUiResponsiveMargin">
                            <form:content>
                                <Label text="{i18n>routing.strategy}" labelFor="routingStrategySelect"/>
                                <Select 
                                    id="routingStrategySelect"
                                    selectedKey="{create>/routingStrategy}"
                                    aria-label="{i18n>aria.routingStrategySelect}"
                                    change=".onRoutingStrategyChange">
                                    <items>
                                        <core:Item key="QUALITY_BASED" text="{i18n>routingQualityBased}"/>
                                        <core:Item key="LOAD_BALANCED" text="{i18n>routingLoadBalanced}"/>
                                        <core:Item key="ROUND_ROBIN" text="{i18n>routingRoundRobin}"/>
                                        <core:Item key="WEIGHTED" text="{i18n>routingWeighted}"/>
                                        <core:Item key="MANUAL" text="{i18n>routingManual}"/>
                                    </items>
                                </Select>
                                
                                <Label text="Auto-Route Threshold"/>
                                <Slider 
                                    value="{create>/autoRouteThreshold}"
                                    min="0"
                                    max="100"
                                    step="5"
                                    enableTickmarks="true"
                                    inputsAsTooltips="true"/>
                                
                                <Label text="{i18n>fallbackOptions}"/>
                                <VBox>
                                    <CheckBox 
                                        text="{i18n>enableFallbackRouting}"
                                        selected="{create>/enableFallback}"/>
                                    <CheckBox 
                                        text="{i18n>requireManualApproval}"
                                        selected="{create>/requireManualApproval}"/>
                                    <CheckBox 
                                        text="{i18n>notifyOnRouting}"
                                        selected="{create>/notifyOnRouting}"/>
                                </VBox>
                                
                                <Label text="{i18n>priorityWeighting}"/>
                                <VBox>
                                    <HBox>
                                        <Label text="{i18n>qualityWeight}"/>
                                        <Slider 
                                            value="{create>/weights/quality}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                    <HBox>
                                        <Label text="{i18n>performanceWeight}"/>
                                        <Slider 
                                            value="{create>/weights/performance}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                    <HBox>
                                        <Label text="{i18n>trustWeight}"/>
                                        <Slider 
                                            value="{create>/weights/trust}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                </VBox>
                            </form:content>
                        </form:SimpleForm>
                    </IconTabFilter>
                    
                    <!-- Trust & Verification Tab -->
                    <IconTabFilter text="{i18n>tab.trustVerification}" icon="sap-icon://key" ariaDescribedBy="trustTabHelp">
                        <core:InvisibleText id="trustTabHelp" text="Configure trust verification level, requirements, and trust factors for quality assessment"/>
                        <form:SimpleForm
                            editable="true"
                            layout="ResponsiveGridLayout"
                            labelSpanXL="4"
                            labelSpanL="4"
                            labelSpanM="12"
                            labelSpanS="12"
                            adjustLabelSpan="false"
                            emptySpanXL="0"
                            emptySpanL="0"
                            emptySpanM="0"
                            columnsXL="2"
                            columnsL="1"
                            columnsM="1"
                            class="sapUiResponsiveMargin">
                            <form:content>
                                <Label text="{i18n>trustVerificationLevel}"/>
                                <Select 
                                    selectedKey="{create>/trustLevel}"
                                    change=".onTrustLevelChange">
                                    <items>
                                        <core:Item key="BASIC" text="{i18n>trustLevelBasic}"/>
                                        <core:Item key="STANDARD" text="{i18n>trustLevelStandard}"/>
                                        <core:Item key="ENHANCED" text="{i18n>trustLevelEnhanced}"/>
                                        <core:Item key="MAXIMUM" text="{i18n>trustLevelMaximum}"/>
                                    </items>
                                </Select>
                                
                                <Label text="{i18n>verificationRequirements}"/>
                                <VBox>
                                    <CheckBox 
                                        text="{i18n>blockchainVerification}"
                                        selected="{create>/verification/blockchain}"/>
                                    <CheckBox 
                                        text="{i18n>reputationCheck}"
                                        selected="{create>/verification/reputation}"/>
                                    <CheckBox 
                                        text="{i18n>integrityValidation}"
                                        selected="{create>/verification/integrity}"/>
                                    <CheckBox 
                                        text="{i18n>consensusRequired}"
                                        selected="{create>/verification/consensus}"/>
                                    <CheckBox 
                                        text="{i18n>signatureValidation}"
                                        selected="{create>/verification/signature}"/>
                                </VBox>
                                
                                <Label text="{i18n>trustFactors}"/>
                                <VBox>
                                    <HBox>
                                        <Label text="{i18n>historicalPerformanceWeight}"/>
                                        <Slider 
                                            value="{create>/trustFactors/performance}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                    <HBox>
                                        <Label text="{i18n>dataQualityWeight}"/>
                                        <Slider 
                                            value="{create>/trustFactors/dataQuality}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                    <HBox>
                                        <Label text="{i18n>securityComplianceWeight}"/>
                                        <Slider 
                                            value="{create>/trustFactors/security}"
                                            min="0"
                                            max="100"
                                            step="10"
                                            width="150px"/>
                                    </HBox>
                                </VBox>
                            </form:content>
                        </form:SimpleForm>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>
        
        <beginButton>
            <Button 
                text="{i18n>button.cancel}"
                press=".onCancelCreateTask"
                aria-label="{i18n>aria.cancelButton}"/>
        </beginButton>
        
        <endButton>
            <Button 
                text="{i18n>button.create}"
                type="Emphasized"
                press=".onConfirmCreateTask"
                enabled="{= ${create>/taskName} &amp;&amp; ${create>/qualityGate} }"
                aria-label="{i18n>aria.createButton}"/>
        </endButton>
        
    </Dialog>
    
</core:FragmentDefinition>