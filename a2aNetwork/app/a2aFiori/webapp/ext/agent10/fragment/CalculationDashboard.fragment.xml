<?xml version="1.0" encoding="UTF-8"?>
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:suite="sap.suite.ui.commons"
    xmlns:viz="sap.viz">
    
    <Dialog
        title="{i18n>dialog.calculationDashboard.title}"
        class="sapUiMediumMargin"
        contentWidth="95vw"
        contentHeight="90vh"
        resizable="true"
        draggable="true">
        
        <content>
            <Page showHeader="false">
                <content>
                    
                    <!-- Key Performance Indicators -->
                    <Panel headerText="{i18n>section.keyMetrics}" class="sapUiMediumMargin">
                        <content>
                            <FlexBox wrap="Wrap" class="sapUiSmallMargin">
                                
                                <!-- Total Calculations -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.totalCalculations}"
                                    subheaderText="{i18n>kpi.allTime}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="12,847"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Active Calculations -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.activeCalculations}"
                                    subheaderText="{i18n>kpi.currentlyRunning}"
                                    valueColor="Neutral"
                                    indicator="None"
                                    value="23"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Average Accuracy -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.averageAccuracy}"
                                    subheaderText="{i18n>kpi.last24Hours}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="99.7%"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Processing Speed -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.processingSpeed}"
                                    subheaderText="{i18n>kpi.operationsPerSecond}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="1,542"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Self-Healing Rate -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.selfHealingRate}"
                                    subheaderText="{i18n>kpi.successfulHealing}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="94.2%"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Resource Efficiency -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.resourceEfficiency}"
                                    subheaderText="{i18n>kpi.cpuMemoryOptimal}"
                                    valueColor="Good"
                                    indicator="None"
                                    value="87.3%"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                            </FlexBox>
                        </content>
                    </Panel>
                    
                    <!-- Performance Charts Section -->
                    <Panel headerText="{i18n>section.performanceAnalysis}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- Performance Trends Chart -->
                                <VBox class="sapUiMediumMarginEnd" width="50%">
                                    <Title text="{i18n>chart.performanceTrends}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="performanceTrendsPopover"/>
                                    <viz:VizFrame
                                        id="performanceTrendsChart"
                                        vizType="line"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/performanceTrends}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Time" value="{timestamp}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Throughput" value="{throughput}"/>
                                                    <viz:MeasureDefinition name="Accuracy" value="{accuracy}"/>
                                                    <viz:MeasureDefinition name="Efficiency" value="{efficiency}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="categoryAxis" type="Dimension" values="Time"/>
                                            <viz:FeedItem uid="valueAxis" type="Measure" values="Throughput,Accuracy,Efficiency"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                                <!-- Engine Comparison Chart -->
                                <VBox width="50%">
                                    <Title text="{i18n>chart.engineComparison}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="engineComparisonPopover"/>
                                    <viz:VizFrame
                                        id="engineComparisonChart"
                                        vizType="column"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/engineMetrics}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Engine" value="{engineName}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Performance" value="{performanceScore}"/>
                                                    <viz:MeasureDefinition name="Accuracy" value="{accuracyScore}"/>
                                                    <viz:MeasureDefinition name="Usage" value="{usagePercentage}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="categoryAxis" type="Dimension" values="Engine"/>
                                            <viz:FeedItem uid="valueAxis" type="Measure" values="Performance,Accuracy,Usage"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                    <!-- Resource Utilization Section -->
                    <Panel headerText="{i18n>section.resourceUtilization}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- CPU Utilization -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.cpuUtilization}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="73"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="73%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- Memory Usage -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.memoryUsage}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="68"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="68%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- GPU Utilization -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.gpuUtilization}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="45"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="45%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- Cache Hit Rate -->
                                <VBox width="25%">
                                    <Title text="{i18n>metric.cacheHitRate}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="92"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="92%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                    <!-- Active Calculations Table -->
                    <Panel headerText="{i18n>section.activeCalculations}" class="sapUiMediumMargin">
                        <content>
                            <Table
                                id="activeCalculationsTable"
                                items="{/activeCalculations}"
                                mode="None"
                                class="sapUiSmallMarginTop">
                                
                                <columns>
                                    <Column>
                                        <Text text="{i18n>field.taskName}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.calculationType}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.progress}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.executionTime}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.calculationEngine}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.status}"/>
                                    </Column>
                                </columns>
                                
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{taskName}"/>
                                            <Text text="{calculationType}"/>
                                            <ProgressIndicator
                                                percentValue="{progress}"
                                                displayValue="{progress}%"
                                                state="Success"/>
                                            <Text text="{executionTime} {i18n>unit.seconds}"/>
                                            <Text text="{calculationEngine}"/>
                                            <ObjectStatus
                                                text="{status}"
                                                state="{
                                                    path: 'status',
                                                    formatter: '.formatStatusState'
                                                }"/>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </content>
                    </Panel>
                    
                    <!-- Error Analysis Section -->
                    <Panel headerText="{i18n>section.errorAnalysis}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- Error Distribution Chart -->
                                <VBox class="sapUiMediumMarginEnd" width="60%">
                                    <Title text="{i18n>chart.errorDistribution}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="errorDistributionPopover"/>
                                    <viz:VizFrame
                                        id="errorDistributionChart"
                                        vizType="donut"
                                        width="100%"
                                        height="250px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/errorDistribution}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="ErrorType" value="{errorType}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Count" value="{count}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="color" type="Dimension" values="ErrorType"/>
                                            <viz:FeedItem uid="size" type="Measure" values="Count"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                                <!-- Self-Healing Statistics -->
                                <VBox width="40%">
                                    <Title text="{i18n>section.selfHealingStats}" level="H4" class="sapUiSmallMarginBottom"/>
                                    
                                    <List items="{/selfHealingStats}" class="sapUiSmallMarginTop">
                                        <StandardListItem
                                            title="{healingType}"
                                            description="{description}"
                                            info="{successRate}%"
                                            infoState="{
                                                path: 'successRate',
                                                formatter: '.formatSuccessRateState'
                                            }"/>
                                    </List>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                </content>
            </Page>
        </content>
        
        <beginButton>
            <Button text="{i18n>btn.refresh}" press="onRefreshDashboard" type="Emphasized"/>
        </beginButton>
        <endButton>
            <Button text="{i18n>btn.close}" press="onCloseDashboard"/>
        </endButton>
        
    </Dialog>
    
</core:FragmentDefinition>