<?xml version="1.0" encoding="UTF-8"?>
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:suite="sap.suite.ui.commons"
    xmlns:viz="sap.viz">
    
    <Dialog
        title="{i18n>dialog.fineTuningDashboard.title}"
        class="sapUiMediumMargin"
        contentWidth="95vw"
        contentHeight="90vh"
        resizable="true"
        draggable="true">
        
        <content>
            <Page showHeader="false">
                <content>
                    
                    <!-- Key Performance Indicators -->
                    <Panel headerText="{i18n>section.keyMetrics}" class="sapUiMediumMargin">
                        <content>
                            <FlexBox wrap="Wrap" class="sapUiSmallMargin">
                                
                                <!-- Total Models -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.totalModels}"
                                    subheaderText="{i18n>kpi.allTypes}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="124"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Active Training Jobs -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.activeTraining}"
                                    subheaderText="{i18n>kpi.currentlyRunning}"
                                    valueColor="Neutral"
                                    indicator="None"
                                    value="8"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Average Accuracy -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.avgAccuracy}"
                                    subheaderText="{i18n>kpi.allModels}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="94.3%"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Inference Speed -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.inferenceSpeed}"
                                    subheaderText="{i18n>kpi.vectorsPerSec}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="12.5K"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Model Compression -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.avgCompression}"
                                    subheaderText="{i18n>kpi.sizeReduction}"
                                    valueColor="Good"
                                    indicator="None"
                                    value="3.2x"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                                <!-- Vector DB Efficiency -->
                                <suite:NumericTile
                                    headerText="{i18n>kpi.vectorDbEfficiency}"
                                    subheaderText="{i18n>kpi.queryPerformance}"
                                    valueColor="Good"
                                    indicator="Up"
                                    value="98.1%"
                                    size="M"
                                    class="sapUiTinyMargin"/>
                                
                            </FlexBox>
                        </content>
                    </Panel>
                    
                    <!-- Training Progress Section -->
                    <Panel headerText="{i18n>section.trainingProgress}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- Loss Convergence Chart -->
                                <VBox class="sapUiMediumMarginEnd" width="50%">
                                    <Title text="{i18n>chart.lossConvergence}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="lossConvergencePopover"/>
                                    <viz:VizFrame
                                        id="lossConvergenceChart"
                                        vizType="line"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/lossConvergence}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Epoch" value="{epoch}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Training Loss" value="{trainingLoss}"/>
                                                    <viz:MeasureDefinition name="Validation Loss" value="{validationLoss}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="categoryAxis" type="Dimension" values="Epoch"/>
                                            <viz:FeedItem uid="valueAxis" type="Measure" values="Training Loss,Validation Loss"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                                <!-- Performance Metrics Chart -->
                                <VBox width="50%">
                                    <Title text="{i18n>chart.performanceMetrics}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="performanceMetricsPopover"/>
                                    <viz:VizFrame
                                        id="performanceMetricsChart"
                                        vizType="combination"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/performanceMetrics}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Model" value="{modelName}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Accuracy" value="{accuracy}"/>
                                                    <viz:MeasureDefinition name="F1 Score" value="{f1Score}"/>
                                                    <viz:MeasureDefinition name="Speed" value="{inferenceSpeed}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="categoryAxis" type="Dimension" values="Model"/>
                                            <viz:FeedItem uid="valueAxis" type="Measure" values="Accuracy,F1 Score"/>
                                            <viz:FeedItem uid="valueAxis2" type="Measure" values="Speed"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                    <!-- Active Fine-Tuning Jobs -->
                    <Panel headerText="{i18n>section.activeJobs}" class="sapUiMediumMargin">
                        <content>
                            <Table
                                id="activeJobsTable"
                                items="{/activeJobs}"
                                mode="None"
                                class="sapUiSmallMarginTop">
                                
                                <columns>
                                    <Column>
                                        <Text text="{i18n>field.jobName}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.modelName}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.progress}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.epoch}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.loss}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.estimatedCompletion}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.status}"/>
                                    </Column>
                                </columns>
                                
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{jobName}"/>
                                            <Text text="{modelName}"/>
                                            <ProgressIndicator
                                                percentValue="{progress}"
                                                displayValue="{progress}%"
                                                state="Success"/>
                                            <Text text="{currentEpoch}/{totalEpochs}"/>
                                            <Text text="{loss}"/>
                                            <Text text="{estimatedCompletion}"/>
                                            <ObjectStatus
                                                text="{jobStatus}"
                                                state="{
                                                    path: 'jobStatus',
                                                    formatter: '.formatJobStatusState'
                                                }"/>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </content>
                    </Panel>
                    
                    <!-- Model Comparison Section -->
                    <Panel headerText="{i18n>section.modelComparison}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- Embedding Distribution -->
                                <VBox class="sapUiMediumMarginEnd" width="50%">
                                    <Title text="{i18n>chart.embeddingDistribution}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="embeddingDistributionPopover"/>
                                    <viz:VizFrame
                                        id="embeddingDistributionChart"
                                        vizType="scatter"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/embeddingDistribution}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Model" value="{model}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Dimension 1" value="{dim1}"/>
                                                    <viz:MeasureDefinition name="Dimension 2" value="{dim2}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="color" type="Dimension" values="Model"/>
                                            <viz:FeedItem uid="valueAxis" type="Measure" values="Dimension 1"/>
                                            <viz:FeedItem uid="valueAxis2" type="Measure" values="Dimension 2"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                                <!-- Benchmark Comparison -->
                                <VBox width="50%">
                                    <Title text="{i18n>chart.benchmarkResults}" level="H4" class="sapUiSmallMarginBottom"/>
                                    <viz:Popover id="benchmarkResultsPopover"/>
                                    <viz:VizFrame
                                        id="benchmarkResultsChart"
                                        vizType="bullet"
                                        width="100%"
                                        height="300px">
                                        <viz:dataset>
                                            <viz:FlattenedDataset data="{/benchmarkResults}">
                                                <viz:dimensions>
                                                    <viz:DimensionDefinition name="Benchmark" value="{benchmarkName}"/>
                                                </viz:dimensions>
                                                <viz:measures>
                                                    <viz:MeasureDefinition name="Score" value="{score}"/>
                                                    <viz:MeasureDefinition name="Baseline" value="{baseline}"/>
                                                    <viz:MeasureDefinition name="Target" value="{target}"/>
                                                </viz:measures>
                                            </viz:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <viz:FeedItem uid="categoryAxis" type="Dimension" values="Benchmark"/>
                                            <viz:FeedItem uid="actualValues" type="Measure" values="Score"/>
                                            <viz:FeedItem uid="targetValues" type="Measure" values="Baseline,Target"/>
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                    <!-- Resource Utilization -->
                    <Panel headerText="{i18n>section.resourceUtilization}" class="sapUiMediumMargin">
                        <content>
                            <HBox class="sapUiMediumMargin">
                                
                                <!-- GPU Utilization -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.gpuUtilization}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="78"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="78%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- Memory Usage -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.memoryUsage}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="65"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="12.4 GB" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- Model Size -->
                                <VBox class="sapUiMediumMarginEnd" width="25%">
                                    <Title text="{i18n>metric.avgModelSize}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="42"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="384 MB" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                                <!-- Training Efficiency -->
                                <VBox width="25%">
                                    <Title text="{i18n>metric.trainingEfficiency}" level="H5" class="sapUiSmallMarginBottom"/>
                                    <suite:RadialMicroChart
                                        size="M"
                                        percentage="91"
                                        valueColor="Good"
                                        class="sapUiSmallMargin"/>
                                    <Text text="91%" class="sapUiSmallMarginTop"/>
                                </VBox>
                                
                            </HBox>
                        </content>
                    </Panel>
                    
                    <!-- Recent Benchmarks -->
                    <Panel headerText="{i18n>section.recentBenchmarks}" class="sapUiMediumMargin">
                        <content>
                            <Table
                                id="recentBenchmarksTable"
                                items="{/recentBenchmarks}"
                                mode="None"
                                class="sapUiSmallMarginTop">
                                
                                <columns>
                                    <Column>
                                        <Text text="{i18n>field.executedAt}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.benchmarkName}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.modelName}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.score}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.rank}"/>
                                    </Column>
                                    <Column>
                                        <Text text="{i18n>field.improvement}"/>
                                    </Column>
                                </columns>
                                
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <Text text="{executedAt}"/>
                                            <Text text="{benchmarkName}"/>
                                            <Link text="{modelName}" press="onNavigateToModel"/>
                                            <ObjectNumber number="{score}" unit="/100" state="Good"/>
                                            <ObjectStatus text="#{rank}" state="Information"/>
                                            <ObjectNumber
                                                number="{improvement}"
                                                unit="%"
                                                state="{
                                                    path: 'improvement',
                                                    formatter: '.formatImprovementState'
                                                }"/>
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </content>
                    </Panel>
                    
                </content>
            </Page>
        </content>
        
        <beginButton>
            <Button text="{i18n>btn.refresh}" press="onRefreshDashboard" type="Emphasized"/>
        </beginButton>
        <endButton>
            <Button text="{i18n>btn.close}" press="onCloseDashboard"/>
        </endButton>
        
    </Dialog>
    
</core:FragmentDefinition>