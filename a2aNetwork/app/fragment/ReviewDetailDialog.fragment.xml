<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form">
    
    <Dialog
        id="reviewDetailDialog"
        title="{i18n>reviewDetails}"
        contentWidth="600px"
        contentHeight="500px">
        
        <content>
            <VBox class="sapUiMediumMargin">
                
                <!-- Review Header -->
                <ObjectHeader
                    title="{reviewDetail>/taskId}"
                    intro="{i18n>taskId}"
                    number="{reviewDetail>/overallRating}"
                    numberUnit="{i18n>stars}"
                    numberState="{= ${reviewDetail>/overallRating} >= 4 ? 'Success' : ${reviewDetail>/overallRating} >= 3 ? 'Warning' : 'Error' }">
                    <attributes>
                        <ObjectAttribute title="{i18n>reviewer}" text="{reviewDetail>/reviewerName}" />
                        <ObjectAttribute title="{i18n>reviewDate}" text="{
                            path: 'reviewDetail>/timestamp',
                            formatter: '.formatter.formatDate'
                        }" />
                    </attributes>
                    <statuses>
                        <ObjectStatus 
                            text="{reviewDetail>/validationStatus}"
                            state="{= ${reviewDetail>/validationStatus} === 'Validated' ? 'Success' : ${reviewDetail>/validationStatus} === 'Pending' ? 'Warning' : 'Error' }" />
                    </statuses>
                </ObjectHeader>
                
                <!-- Rating Details -->
                <Panel headerText="{i18n>ratingBreakdown}" class="sapUiMediumMarginTop">
                    <content>
                        <form:SimpleForm
                            editable="false"
                            layout="ResponsiveGridLayout"
                            labelSpanXL="4"
                            labelSpanL="4"
                            labelSpanM="4"
                            labelSpanS="12">
                            <form:content>
                                
                                <Label text="{i18n>performanceRating}:" />
                                <HBox>
                                    <RatingIndicator
                                        maxValue="5"
                                        value="{reviewDetail>/performanceRating}"
                                        editable="false" />
                                    <Text text=" ({reviewDetail>/performanceRating}/5)" class="sapUiSmallMarginBegin" />
                                </HBox>
                                
                                <Label text="{i18n>accuracyRating}:" />
                                <HBox>
                                    <RatingIndicator
                                        maxValue="5"
                                        value="{reviewDetail>/accuracyRating}"
                                        editable="false" />
                                    <Text text=" ({reviewDetail>/accuracyRating}/5)" class="sapUiSmallMarginBegin" />
                                </HBox>
                                
                                <Label text="{i18n>communicationRating}:" />
                                <HBox>
                                    <RatingIndicator
                                        maxValue="5"
                                        value="{reviewDetail>/communicationRating}"
                                        editable="false" />
                                    <Text text=" ({reviewDetail>/communicationRating}/5)" class="sapUiSmallMarginBegin" />
                                </HBox>
                                
                                <Label text="{i18n>overallRating}:" />
                                <HBox>
                                    <RatingIndicator
                                        maxValue="5"
                                        value="{reviewDetail>/overallRating}"
                                        editable="false" />
                                    <Text text=" ({reviewDetail>/overallRating}/5)" class="sapUiSmallMarginBegin" />
                                </HBox>
                                
                            </form:content>
                        </form:SimpleForm>
                    </content>
                </Panel>
                
                <!-- Review Comments -->
                <Panel headerText="{i18n>reviewComments}" class="sapUiMediumMarginTop">
                    <content>
                        <Text 
                            text="{reviewDetail>/comments}" 
                            class="sapUiSmallMargin"
                            renderWhitespace="true" />
                    </content>
                </Panel>
                
                <!-- Validation Information -->
                <Panel 
                    headerText="{i18n>validationInfo}" 
                    class="sapUiMediumMarginTop"
                    visible="{= ${reviewDetail>/validationStatus} !== undefined }">
                    <content>
                        <form:SimpleForm
                            editable="false"
                            layout="ResponsiveGridLayout"
                            labelSpanXL="4"
                            labelSpanL="4"
                            labelSpanM="4"
                            labelSpanS="12">
                            <form:content>
                                
                                <Label text="{i18n>validationStatus}:" />
                                <Text text="{reviewDetail>/validationStatus}" />
                                
                                <Label text="{i18n>validatorCount}:" />
                                <Text text="{reviewDetail>/validatorCount}" />
                                
                                <Label text="{i18n>reviewerAddress}:" />
                                <Text text="{reviewDetail>/reviewerAddress}" />
                                
                            </form:content>
                        </form:SimpleForm>
                    </content>
                </Panel>
                
            </VBox>
        </content>
        
        <beginButton>
            <Button
                text="{i18n>validateReview}"
                type="Emphasized"
                press=".onValidateReview"
                visible="{= ${reviewDetail>/validationStatus} === 'Pending' }" />
        </beginButton>
        
        <endButton>
            <Button
                text="{i18n>close}"
                press=".onCloseReviewDetail" />
        </endButton>
        
    </Dialog>
</core:FragmentDefinition>