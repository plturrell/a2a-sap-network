<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.f"
    xmlns:l="sap.ui.layout">
    
    <Dialog
        title="Print Preview - Projects List Report"
        resizable="true"
        draggable="true"
        contentWidth="900px"
        contentHeight="700px"
        type="Message">
        
        <content>
            <VBox class="sapUiSmallMargin">
                
                <!-- Print Settings Panel -->
                <Panel headerText="Print Settings" expandable="true" expanded="false" class="sapUiSmallMarginBottom">
                    <content>
                        <l:Grid defaultSpan="L4 M6 S12" class="sapUiSmallMargin">
                            
                            <!-- Paper Size -->
                            <VBox>
                                <Label text="Paper Size:" class="sapMTextBold"/>
                                <Select selectedKey="{printPreview>/settings/paperSize}"
                                       change=".onPrintSettingChange">
                                    <core:Item key="A4" text="A4 (210 × 297 mm)"/>
                                    <core:Item key="Letter" text="Letter (8.5 × 11 in)"/>
                                    <core:Item key="Legal" text="Legal (8.5 × 14 in)"/>
                                    <core:Item key="A3" text="A3 (297 × 420 mm)"/>
                                </Select>
                            </VBox>
                            
                            <!-- Orientation -->
                            <VBox>
                                <Label text="Orientation:" class="sapMTextBold"/>
                                <RadioButtonGroup selectedIndex="{= ${printPreview>/settings/orientation} === 'portrait' ? 0 : 1 }"
                                                 select=".onOrientationChange">
                                    <RadioButton text="Portrait"/>
                                    <RadioButton text="Landscape"/>
                                </RadioButtonGroup>
                            </VBox>
                            
                            <!-- Margins -->
                            <VBox>
                                <Label text="Margins:" class="sapMTextBold"/>
                                <Select selectedKey="{printPreview>/settings/margins}"
                                       change=".onPrintSettingChange">
                                    <core:Item key="normal" text="Normal (1 inch)"/>
                                    <core:Item key="narrow" text="Narrow (0.5 inch)"/>
                                    <core:Item key="wide" text="Wide (1.5 inch)"/>
                                    <core:Item key="none" text="None"/>
                                </Select>
                            </VBox>
                            
                            <!-- Content Selection -->
                            <VBox>
                                <Label text="Include:" class="sapMTextBold"/>
                                <CheckBox text="Page Header" selected="{printPreview>/settings/includeHeader}"/>
                                <CheckBox text="KPI Cards" selected="{printPreview>/settings/includeKPIs}"/>
                                <CheckBox text="Filters Summary" selected="{printPreview>/settings/includeFilters}"/>
                                <CheckBox text="Page Numbers" selected="{printPreview>/settings/includePageNumbers}"/>
                                <CheckBox text="Timestamp" selected="{printPreview>/settings/includeTimestamp}"/>
                            </VBox>
                            
                            <!-- Columns Selection -->
                            <VBox>
                                <Label text="Table Columns:" class="sapMTextBold"/>
                                <CheckBox text="Status" selected="{printPreview>/settings/columns/status}"/>
                                <CheckBox text="Priority" selected="{printPreview>/settings/columns/priority}"/>
                                <CheckBox text="Agents" selected="{printPreview>/settings/columns/agents}"/>
                                <CheckBox text="Last Deployment" selected="{printPreview>/settings/columns/lastDeployment}"/>
                                <CheckBox text="Created By" selected="{printPreview>/settings/columns/createdBy}"/>
                            </VBox>
                            
                            <!-- Print Range -->
                            <VBox>
                                <Label text="Print Range:" class="sapMTextBold"/>
                                <RadioButtonGroup selectedIndex="{printPreview>/settings/rangeType}"
                                                 select=".onRangeTypeChange">
                                    <RadioButton text="All Pages"/>
                                    <RadioButton text="Current Page"/>
                                    <RadioButton text="Custom Range"/>
                                </RadioButtonGroup>
                                <Input placeholder="e.g., 1-3, 5, 7-10" 
                                      value="{printPreview>/settings/customRange}"
                                      visible="{= ${printPreview>/settings/rangeType} === 2 }"/>
                            </VBox>
                            
                        </l:Grid>
                    </content>
                </Panel>
                
                <!-- Preview Area -->
                <Panel headerText="Preview" class="sapUiSmallMarginBottom">
                    <headerToolbar>
                        <OverflowToolbar>
                            <Title text="Preview"/>
                            <ToolbarSpacer/>
                            <SegmentedButton selectedKey="{printPreview>/previewScale}">
                                <items>
                                    <SegmentedButtonItem key="50" text="50%"/>
                                    <SegmentedButtonItem key="75" text="75%"/>
                                    <SegmentedButtonItem key="100" text="100%"/>
                                    <SegmentedButtonItem key="125" text="125%"/>
                                </items>
                                <selectionChange>.onPreviewScaleChange</selectionChange>
                            </SegmentedButton>
                            <Button icon="sap-icon://zoom-in" press=".onZoomIn" tooltip="Zoom In"/>
                            <Button icon="sap-icon://zoom-out" press=".onZoomOut" tooltip="Zoom Out"/>
                            <Button icon="sap-icon://fit-to-screen" press=".onFitToScreen" tooltip="Fit to Screen"/>
                        </OverflowToolbar>
                    </headerToolbar>
                    <content>
                        <ScrollContainer height="450px" width="100%" horizontal="true" vertical="true">
                            <VBox id="printPreviewContainer" 
                                  class="sapUiMediumMargin a2a-print-preview-container"
                                  style="background: white; box-shadow: 0 0 10px rgba(0,0,0,0.1); transform: scale({= ${printPreview>/previewScale} / 100 }); transform-origin: top left;">
                                
                                <!-- Dynamic content will be rendered here -->
                                
                            </VBox>
                        </ScrollContainer>
                    </content>
                </Panel>
                
                <!-- Page Navigation -->
                <HBox alignItems="Center" justifyContent="Center" class="sapUiSmallMarginBottom">
                    <Button icon="sap-icon://media-rewind" 
                           press=".onFirstPage" 
                           tooltip="First Page"
                           enabled="{= ${printPreview>/currentPage} > 1 }"/>
                    <Button icon="sap-icon://media-play" 
                           iconFirst="false"
                           press=".onPreviousPage" 
                           tooltip="Previous Page"
                           enabled="{= ${printPreview>/currentPage} > 1 }"/>
                    <Text text="Page {printPreview>/currentPage} of {printPreview>/totalPages}" 
                         class="sapUiSmallMarginBeginEnd"/>
                    <Button icon="sap-icon://media-play" 
                           press=".onNextPage" 
                           tooltip="Next Page"
                           enabled="{= ${printPreview>/currentPage} < ${printPreview>/totalPages} }"/>
                    <Button icon="sap-icon://media-forward" 
                           press=".onLastPage" 
                           tooltip="Last Page"
                           enabled="{= ${printPreview>/currentPage} < ${printPreview>/totalPages} }"/>
                </HBox>
                
            </VBox>
        </content>
        
        <buttons>
            <Button text="Print" 
                    icon="sap-icon://print"
                    type="Emphasized"
                    press=".onPrint"/>
            <Button text="Export PDF" 
                    icon="sap-icon://pdf-attachment"
                    type="Default"
                    press=".onExportPDF"/>
            <Button text="Page Setup" 
                    icon="sap-icon://action-settings"
                    type="Default"
                    press=".onPageSetup"/>
            <Button text="Close" 
                    icon="sap-icon://decline"
                    type="Default"
                    press=".onClosePrintPreview"/>
        </buttons>
    </Dialog>
</core:FragmentDefinition>